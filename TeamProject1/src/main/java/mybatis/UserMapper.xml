<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="mybatis.userMapper">
    <resultMap id="user" type="vo.User">
        <id property="no" column="no"/>
        <result property="id" column="id"/>
        <result property="imgUrl" column="img_url"/>
        <result property="pw" column="pw"/>
        <result property="name" column="name"/>
        <result property="nickname" column="nickname"/>
        <result property="cash" column="cash"/>
        <result property="phone" column="phone"/>
        <result property="location" column="location"/>
        <result property="regDate" column="regDate"/>
        <result property="penalty" column="penalty"/>
        <result property="deliver" column="deliver"/>
        <result property="status" column="status"/>
    </resultMap>

    <select id="userList" resultType="user">
        SELECT *
        FROM user
    </select>

    <insert id="userInsert" parameterType="user"> INSERT INTO user (id, pw, name, phone, nickname)
                                                  VALUES (#{id}, #{pw}, #{name}, #{phone}, #{nickname}) </insert>


    <select id="validUserId" parameterType="String" resultType="Integer">
        SELECT COUNT(*)
        FROM user
        WHERE id = #{id}
    </select>

    <select id="checkLogin" parameterType="user" resultType="String">
        SELECT name
        FROM user
        WHERE id = #{id}
          AND pw = #{pw}
    </select>

    <select id="getUserNo" parameterType="String" resultType="Integer">
        SELECT no
        FROM user
        WHERE id=#{id}
    </select>

    <delete id="userDelete" parameterType="String">
        DELETE
        FROM user
        WHERE id = #{id}
    </delete>

    <select id="getOneUser" parameterType="Integer" resultMap="user"> SELECT * FROM user where no=#{no} </select>


    <update id="userUpdate" parameterType="user"> update user set pw=#{pw}, nickname=#{nickname}, phone=#{phone}, deliver=#{deliver} where id=#{id} </update>

    <update id="locationUpdate" parameterType="user">
        UPDATE user
        SET location=#{location}
        WHERE no =#{no}
    </update>

    <update id="userUploadPhoto" parameterType="user">
        UPDATE user
        SET img_url=#{imgUrl}
        WHERE no =#{no}
    </update>

    <select id="userLogin" parameterType="user" resultType="String">
        SELECT name
        FROM user
        WHERE id = #{id}
          AND pw = #{pw}
    </select>

    <select id="getUserByLocation" parameterType="String" resultType="user">
        SELECT *
        FROM user
        WHERE location LIKE CONCAT('%', #{location}, '%')
    </select>
</mapper>
